@{
    Layout = "~/Views/Shared/_LayoutInner.cshtml";
    ViewBag.Title = "أحكام المحاكم العربية العليا ";
 }

<div class="title-module">
    <h1><span class="main-title">منظومة أحكام المحاكم العربية</span></h1>
    <p>أنتجت إدارة قوانين الشرق منظومة أحكام المحاكم العربية العليا بعد أن قامت بتحليل اتجاهات الأحكام ،</p>
</div>
<hr class="spacer" />
@Html.Partial("_ManzomatLinks")

<div class="main" ng-app="ahkamApp">
    <div class="col-lg-12" ng-controller="ahkamCtrl">
        <!-- Nav tabs -->
        <div class="card">
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab"> بحث عام</a></li>
                <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">بحث متقدم</a></li>
                <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">بحث متخصص</a></li>
                <li role="presentation"><a href="#mada" aria-controls="mada" role="tab" data-toggle="tab">بحث بتطبيقات المادة</a></li>
            </ul>

            <!-- Tab panes -->
       <div class="tab-content">

             <div role="tabpanel" class="tab-pane active" id="home">
                   <div class="search-form form-horizontal" ng-controller="GeneralSearchCtrl"> @Html.Partial("_GeneralSearch")</div>
             </div>
              
             <div role="tabpanel" class="tab-pane" id="profile">
                   <div class="search-form form-horizontal" ng-controller="AdvancedSearchCtrl"> @Html.Partial("_AdvancedSearch")</div>
             </div>

             <div role="tabpanel" class="tab-pane" id="messages" >
                   <div class="search-form form-horizontal" ng-controller="SpecialSearchCtrl"> @Html.Partial("_SpecialSearch")</div>
              </div>

             <div role="tabpanel" class="tab-pane" id="mada">
                 <div class="search-form form-horizontal">@Html.Partial("_tadbekMadaSearch")</div>
              </div>

          </div>
        </div>
        <div class="result-search">
            <p class="total-chart"> <i class="fa fa-line-chart "></i> وجد اجمالي [68] تشريع </p>
    
            <div class="col-lg-9 col-md-8  col-sm-8 list-content">
                <div class="filter-element">@Html.Partial("_filterElement") </div>
                <hr class="spacer" />

                <div id="searchResult"></div>
                <div class="paging-search text-center" ng-controller="pagesCtrl">

                    <h1 id="pagenumber"></h1>
                    <c-pageing pages-count="46"  limit-no="10" current-page="mypage"  on-getpage="getmypage()"> </c-pageing>

                </div>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-4 filter-search"> @Html.Partial("_filterSearch") </div>

            <hr class="spacer" />
        </div>
        <hr class="spacer" />
    </div>
</div>



<script>

    (function () {
        var app = angular.module('ahkamApp', ['sharedModule']);
        app
        .controller('ahkamCtrl', function () { })
        .controller('GeneralSearchCtrl', function ($scope, $http, SearchResult) {
            $scope.search = function () {
                //$http.get('/Ahkam/SearchResult',
                //    { params: { "q": $scope.txtsearch.trim() } }).then(function (d) {
                //        console.log(d.data);
                //        $('#searchResult').html(d.data);
                //    });
                SearchResult.data.inputSearch.text = $scope.txtsearch;
                SearchResult.simpleSearch(1);
                SearchResult.searchType = 1; // set search type is simple
            };
        })
        .controller('AdvancedSearchCtrl', function () { })
        .controller('SpecialSearchCtrl', function () { })
        .controller('pagesCtrl', function ($scope, SearchResult) {

            $scope.mypage = 1;
            $scope.getmypage = function () {
                $('#pagenumber').html('current Page is : ' + $scope.mypage);
                if (SearchResult.searchType == 1) {
                    SearchResult.simpleSearch($scope.mypage);
                }
            }

            $scope.getmypage();

        });


        app
        .factory('SearchResult', function ($http) {
            var data = {};
           
            data.searchType = 1; //1 simplesearch 2 advancedserch 3 .... etc
            data.inputSearch = {};
            data.inputSearch.text = '';
            data.simpleSearch = function (page) {
                console.log(data.inputSearch)
                var txtsearch = 'القتل العمد'; // data.inputSearch.text;
                $http.get('/Ahkam/SearchResult',
                    { params: { "q": txtsearch } }).then(function (d) {
                        //console.log(d.data);
                        $('#searchResult').html(d.data);
                    });
              //  alert('get data of page ' + page + ' search ' + txtsearch);
            };

            return data;
        });

    })();

</script>
