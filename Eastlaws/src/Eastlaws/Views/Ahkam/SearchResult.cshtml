@model Eastlaws.Entities.AhkamPresentation
@{
    Layout = null;

    var countrow = 0;
}

0000
@ViewBag.typeView

@if (Model != null)
{

    <input type="hidden" value="@Model.ResultsCount" id="resultCount" />
    <input type="hidden" value="@Model.QueryID" id="queryHandle" />

    @if (!string.IsNullOrWhiteSpace(Model.PresentationTitle))
    {
        <h4 class="text-center">
            <i class="fa fa-balance-scale" aria-hidden="true"></i>
            <span class="">
                @Model.PresentationTitle
            </span>
        </h4>

    }

    @foreach (var item in Model.AhkamList)
    {
        countrow += 1;

        var Fakrat = Model.FakaratList.Where(p => p.HokmID == @item.ID).ToArray();
        var PredicatesHighlight = Model.TextPredicates;
        int MaxFakraTextLen = 250;


        <div class="result-block">
            <h4><i class="fa fa-bank fa-2x icon"></i></h4>
            <div class="row-search selector">


                <h3><img src="~/Content/images/Flags/Small/@item.CountryFlagPic" width="16" height="11" alt="" />&nbsp; @item.FullName</h3>
                @for (int i = 0; i < Fakrat.Length; i++)
                {
                    var CurrentFakra = Fakrat[i];
                    string FakraText = CurrentFakra.Text;
                    if (PredicatesHighlight == null || PredicatesHighlight.Count == 0)
                    {
                        FakraText = FakraText.Substring(0, Math.Min(FakraText.Length, MaxFakraTextLen));

                    }
                    else
                    {
                        var MatchingPredicate = (from x in PredicatesHighlight
                                                 where Convert.ToInt32(x.Tag) == CurrentFakra.FakraNo || Convert.ToInt32(x.Tag) == 5000
                                                 orderby Convert.ToInt32(x.Tag)
                                                 select x ).FirstOrDefault();

                        if (MatchingPredicate == null)
                        {
                            FakraText = FakraText.Substring(0, Math.Min(FakraText.Length, MaxFakraTextLen));
                        }
                        else
                        {
                            FakraText = Eastlaws.Infrastructure.Temp.HighlightTextTrim(FakraText, MatchingPredicate.Input, MatchingPredicate.SqlMode, MaxFakraTextLen);
                        }
                    }

                    <p c-font-scale="{{fontsize}}">
                        <span class="fakr-title-search" style="color:red;">
                            @CurrentFakra.Title :
                        </span>
                        <a target="_blank" href="View?ID=@item.ID#@CurrentFakra.ID">@Html.Raw(FakraText)</a>
                    </p>

                    if (i < Fakrat.Length - 1 && Fakrat.Length > 1)
                    {
                        <div class="fakarat-search-separator">
                            <hr />
                        </div>
                    }
                }


                <div class="nav-control">
                    <ul>
                        <li><a href="#"><i class="fa fa-desktop"></i> قراءة النص</a></li>
                        <li><a href="#"><i class="fa fa-camera"></i> صورة الحكم</a></li>
                        <li><a href="#"><i class="fa fa-print"></i> طباعة </a></li>
                    </ul>
                </div>
                <hr class="spacer" />
            </div>
        </div>
        @if (countrow % 3 == 0)
        {
            <hr class="spacer" />
        }
    }
    @if (countrow == 0)
    {
        <h3>لا يوجد نتائج</h3>
    }
}
else if (Model == null)
{
    <h3>لا يوجد نتائج</h3>
}

